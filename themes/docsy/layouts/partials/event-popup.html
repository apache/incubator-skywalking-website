{{ $scratchTotal := newScratch }}

{{ range first 50 (where .Site.Pages "Section" "events")  }}
{{ if .Params.endTime }}
{{ if (time .Params.endTime).After now }}
{{ $scratchTotal.Add "total" 1 }}
{{ end }}
{{ end }}
{{ end }}


{{if ($scratchTotal.Get "total")}}
<div class="sky-event-popup">

    <div class="sky-pop-modal">
        <i class="fa fa-window-close"></i>
        <div class="pic-wrapper">
            <img
                    data-img="/images/skywalking_200x200.png"
                    class="pic"
                    alt="event"
            />
        </div>

        <div class="content-box">
            {{ range first 50 (where .Site.Pages "Section" "events") }}
            {{ if .Params.endTime }}
            {{ if (time .Params.endTime).After now }}

            <div class="item"
                 data-img="{{.Params.img}}"
                 data-starttime="{{.Params.startTime}}"
                 data-endtime="{{.Params.endTime}}">
                <a href="{{.RelPermalink}}">
                    <h3 class="title">{{ .LinkTitle }}</h3>
                    <p class="content-text">
                        {{.Params.description}}
                    </p>
                </a>

                <a href="{{.RelPermalink}}" class="modal-btn">
                    {{if .Params.buttonText }}
                    {{ .Params.buttonText }}
                    {{else}}
                    Read more
                    {{end}}
                </a>
            </div>
            {{ end }}
            {{ end }}
            {{ end }}
        </div>
    </div>
</div>

{{end}}

